{"version":3,"file":"pods-dfv.min.js","sources":["_src/core/pods-field-model.js","_src/core/gb-modal-listener.js","_src/core/pods-field-views.js","_src/file-upload/file-upload-model.js","_src/file-upload/views/file-upload-list.js","_src/file-upload/views/file-upload-form.js","_src/file-upload/uploaders/pods-file-uploader.js","_src/file-upload/views/file-upload-queue.js","_src/file-upload/file-upload.js","_src/file-upload/uploaders/plupload.js","_src/file-upload/uploaders/media-modal.js","_src/core/dfv-modal.js","_src/core/iframe-frame.js","_src/pick/relationship-model.js","_src/pick/pick-field-model.js","_src/pick/views/radio-view.js","_src/pick/views/checkbox-view.js","_src/pick/views/select-view.js","_src/pick/views/list-view.js","_src/pick/views/add-new.js","_src/pick/pick.js","_src/pods-dfv.js"],"sourcesContent":["/*global jQuery, _, Backbone, Marionette */\nexport const PodsDFVFieldModel = Backbone.Model.extend( {\n\tdefaults: {\n\t\thtmlAttr: {},\n\t\tfieldConfig: {}\n\t}\n} );\n","/**\n * Note: No checking is done here to make sure we're in a modal and that\n * Gutenberg is actually loaded.  Consuming code must make sure the implicit\n * Gutenberg dependencies exist (primarily wp.data) before calling through\n * to init().\n */\n\n// The guard in front is to ensure wp.data exists before accessing select\nconst editorData = wp.data && wp.data.select( 'core/editor' );\nlet unSubscribe;\n\n/**\n * init() is the only exposed interface\n */\nexport const PodsGbModalListener = {\n\tinit: function () {\n\t\tif ( editorData.isCurrentPostPublished() ) {\n\t\t\t// Post is published, this is an edit\n\t\t\tunSubscribe = wp.data.subscribe( saveListener );\n\t\t} else {\n\t\t\t// Unpublished post, this is an \"add new\" modal\n\t\t\tunSubscribe = wp.data.subscribe( publishListener );\n\t\t}\n\t}\n};\n\n//-------------------------------------------\n// Helper functions, not externally exposed\n//-------------------------------------------\n\n/**\n * Handles \"add new\" modals\n */\nfunction publishListener () {\n\n\tif ( editorData.isCurrentPostPublished() ) {\n\t\tunSubscribe();\n\t\ttriggerUpdateEvent( {\n\t\t\t'link': editorData.getPermalink(),\n\t\t\t'edit_link': `post.php?post=${editorData.getCurrentPostId()}&action=edit`,\n\t\t\t'selected': true // Automatically select add new records\n\t\t} );\n\t}\n}\n\n/**\n * Handles \"edit existing\" modals\n */\nfunction saveListener () {\n\n\tif ( saveListener.wasSaving ) {\n\n\t\t// The wasSaving flag already ignores autosave so we only need to\n\t\t// check isSavingPost()\n\t\tif ( !editorData.isSavingPost() ) {\n\n\t\t\t// Currently on save failure we'll remain subscribed and try\n\t\t\t// listening for the next save attempt\n\t\t\tsaveListener.wasSaving = false;\n\n\t\t\tif ( editorData.didPostSaveRequestSucceed() ) {\n\t\t\t\tunSubscribe();\n\t\t\t\ttriggerUpdateEvent();\n\t\t\t}\n\t\t}\n\t} else {\n\t\tsaveListener.wasSaving = isUserSaving();\n\t}\n}\n\n/**\n * Whether or not an active save is in progress due to user action (ignore autosaves)\n *\n * @return boolean\n */\nfunction isUserSaving () {\n\treturn !!( editorData.isSavingPost() && !editorData.isAutosavingPost() );\n}\n\n/**\n * The event listener in the parent window will take care of closing the modal\n */\nfunction triggerUpdateEvent ( optionalData ) {\n\tconst defaultData = {\n\t\t'id': editorData.getCurrentPostId(),\n\t\t'name': editorData.getCurrentPostAttribute( 'title' )\n\t};\n\tconst postData = Object.assign( defaultData, optionalData );\n\n\twindow.parent.jQuery( window.parent ).trigger( 'dfv:modal:update', postData );\n}\n","/*global jQuery, _, Backbone, Marionette */\n\n/**\n *\n */\nexport const PodsFieldListView = Marionette.CollectionView.extend( {\n\tchildViewEventPrefix: false, // Disable implicit event listeners in favor of explicit childViewTriggers and childViewEvents\n\n\tinitialize: function ( options ) {\n\t\tthis.fieldModel = options.fieldModel;\n\t\tthis.childViewOptions = { fieldModel: options.fieldModel };\n\t}\n} );\n\n/**\n * @extends Backbone.View\n */\nexport const PodsFieldView = Marionette.View.extend( {\n\tchildViewEventPrefix: false, // Disable implicit event listeners in favor of explicit childViewTriggers and childViewEvents\n\n\tserializeData: function () {\n\t\tconst fieldModel = this.options.fieldModel;\n\t\tlet data = this.model ? this.model.toJSON() : {};\n\n\t\tdata.htmlAttr = fieldModel.get( 'htmlAttr' );\n\t\tdata.fieldConfig = fieldModel.get( 'fieldConfig' );\n\n\t\treturn data;\n\t}\n} );\n\n/**\n * Top-level \"main field container\"\n */\nexport const PodsDFVFieldLayout = Marionette.View.extend( {\n\tchildViewEventPrefix: false, // Disable implicit event listeners in favor of explicit childViewTriggers and childViewEvents\n\n\tinitialize: function ( options ) {\n\t\tthis.fieldItemData = options.fieldItemData;\n\t}\n} );\n","/*global jQuery, _, Backbone, Marionette */\n/**\n *\n */\nexport const FileUploadModel = Backbone.Model.extend( {\n\tdefaults: {\n\t\t'id': 0,\n\t\t'icon': '',\n\t\t'name': '',\n\t\t'edit_link': '',\n\t\t'link': '',\n\t\t'download': ''\n\t}\n} );\n\n/**\n *\n */\nexport const FileUploadCollection = Backbone.Collection.extend( {\n\tmodel: FileUploadModel\n} );\n","/*global jQuery, _, Backbone, Marionette, wp */\nimport template from 'pods-dfv/_src/file-upload/views/file-upload-item.html';\n\nimport { PodsFieldListView, PodsFieldView } from 'pods-dfv/_src/core/pods-field-views';\n\n/**\n * Individual list items, representing a single file\n */\nexport const FileUploadItem = PodsFieldView.extend( {\n\tchildViewEventPrefix: false, // Disable implicit event listeners in favor of explicit childViewTriggers and childViewEvents\n\n\ttagName: 'li',\n\n\ttemplate: _.template( template ),\n\n\tclassName: 'pods-dfv-list-item',\n\n\tui: {\n\t\tdragHandle: '.pods-dfv-list-handle',\n\t\teditLink: '.pods-dfv-list-edit-link',\n\t\tviewLink: '.pods-dfv-list-link',\n\t\tdownloadLink: '.pods-dfv-list-download',\n\t\tremoveButton: '.pods-dfv-list-remove',\n\t\titemName: '.pods-dfv-list-name'\n\t},\n\n\ttriggers: {\n\t\t'click @ui.removeButton': 'remove:file:click'\n\t}\n} );\n\n/**\n * The file list container\n */\nexport const FileUploadList = PodsFieldListView.extend( {\n\tchildViewEventPrefix: false, // Disable implicit event listeners in favor of explicit childViewTriggers and childViewEvents\n\n\ttagName: 'ul',\n\n\tclassName: 'pods-dfv-list',\n\n\tchildView: FileUploadItem,\n\n\tchildViewTriggers: {\n\t\t'remove:file:click': 'childview:remove:file:click'\n\t},\n\n\tonAttach: function () {\n\t\tconst fieldConfig = this.options.fieldModel.get( 'fieldConfig' );\n\t\tlet sort_axis = 'y';\n\n\t\t// @todo\n\t\t// http://stackoverflow.com/questions/1735372/jquery-sortable-list-scroll-bar-jumps-up-when-sorting/4187833#4187833\n\n\t\tif ( 1 != fieldConfig[ 'file_limit' ] ) {\n\n\t\t\tif ( 'tiles' == fieldConfig[ 'file_field_template' ] ) {\n\t\t\t\tsort_axis = '';\n\t\t\t}\n\n\t\t\t// init sortable\n\t\t\tthis.$el.sortable( {\n\t\t\t\tcontainment: 'parent',\n\t\t\t\taxis: sort_axis,\n\t\t\t\tscrollSensitivity: 40,\n\t\t\t\ttolerance: 'pointer',\n\t\t\t\topacity: 0.6\n\t\t\t} );\n\t\t}\n\t}\n} );\n\n","/*global jQuery, _, Backbone, Marionette, wp */\nimport template from 'pods-dfv/_src/file-upload/views/file-upload-form.html';\n\nimport { PodsFieldView } from 'pods-dfv/_src/core/pods-field-views';\n\nexport const FileUploadForm = PodsFieldView.extend( {\n\tchildViewEventPrefix: false, // Disable implicit event listeners in favor of explicit childViewTriggers and childViewEvents\n\n\ttagName: 'div',\n\n\ttemplate: _.template( template ),\n\n\tui: {\n\t\taddButton: '.pods-dfv-list-add'\n\t},\n\n\ttriggers: {\n\t\t'click @ui.addButton': 'childview:add:file:click'\n\t}\n} );\n","/*global jQuery, _, Backbone, Marionette */\n/**\n *\n * @param {Object} options\n *\n * @param {Object} options.browseButton   Existing and attached DOM node\n * @param {Object} options.uiRegion       Marionette.Region object\n * @param {Object} options.fieldConfig\n *\n * @param {string} options.fieldConfig.file_modal_title\n * @param {string} options.fieldConfig.file_modal_add_button\n * @param {string} options.fieldConfig.file_limit\n * @param {string} options.fieldConfig.limit_extensions\n * @param {string} options.fieldConfig.limit_types\n * @param {string} options.fieldConfig.file_attachment_tab\n *\n * @param {Object} options.fieldConfig.plupload_init\n * @param {Object} options.fieldConfig.plupload_init.browse_button\n *\n * @class\n */\nexport const PodsFileUploader = Marionette.Object.extend( {\n\n\tconstructor: function ( options ) {\n\t\t// Magically set the object properties we need, they'll just \"be there\" for the concrete instance\n\t\tthis.browseButton = options.browseButton;\n\t\tthis.uiRegion = options.uiRegion;\n\t\tthis.fieldConfig = options.fieldConfig;\n\n\t\tMarionette.Object.call( this, options );\n\t}\n\n} );\n\n","/*global jQuery, _, Backbone, Marionette, wp */\nimport template from 'pods-dfv/_src/file-upload/views/file-upload-queue.html';\n\nexport const FileUploadQueueModel = Backbone.Model.extend( {\n\tdefaults: {\n\t\tid: 0,\n\t\tfilename: '',\n\t\tprogress: 0,\n\t\terrorMsg: ''\n\t}\n} );\n\n/**\n *\n */\nexport const FileUploadQueueItem = Marionette.View.extend( {\n\tmodel: FileUploadQueueModel,\n\n\ttagName: 'li',\n\n\ttemplate: _.template( template ),\n\n\tattributes: function () {\n\t\treturn {\n\t\t\tclass: 'pods-dfv-list-item',\n\t\t\tid: this.model.get( 'id' )\n\t\t};\n\t},\n\n\tmodelEvents: {\n\t\t'change': 'onModelChanged'\n\t},\n\n\tonModelChanged: function () {\n\t\tthis.render();\n\t}\n\n} );\n\n/**\n *\n */\nexport const FileUploadQueue = Marionette.CollectionView.extend( {\n\ttagName: 'ul',\n\n\tclassName: 'pods-dfv-list pods-dfv-list-queue',\n\n\tchildView: FileUploadQueueItem\n} );\n","/*global jQuery, _, Backbone, Marionette */\nimport template from 'pods-dfv/_src/file-upload/file-upload-layout.html';\n\nimport { PodsDFVFieldLayout } from 'pods-dfv/_src/core/pods-field-views';\n\nimport { FileUploadCollection } from 'pods-dfv/_src/file-upload/file-upload-model';\n\nimport { FileUploadList } from 'pods-dfv/_src/file-upload/views/file-upload-list';\nimport { FileUploadForm } from 'pods-dfv/_src/file-upload/views/file-upload-form';\n\nimport { Plupload } from 'pods-dfv/_src/file-upload/uploaders/plupload';\nimport { MediaModal } from 'pods-dfv/_src/file-upload/uploaders/media-modal';\n\nconst Uploaders = [\n\tPlupload,\n\tMediaModal\n];\n\nconst UNLIMITED_FILES = 0;\n\n/**\n * @extends Backbone.View\n */\nexport const FileUpload = PodsDFVFieldLayout.extend( {\n\tchildViewEventPrefix: false, // Disable implicit event listeners in favor of explicit childViewTriggers and childViewEvents\n\n\ttemplate: _.template( template ),\n\n\tregions: {\n\t\tlist: '.pods-ui-file-list',\n\t\tuiRegion: '.pods-ui-region', // \"Utility\" container for uploaders to use\n\t\tform: '.pods-ui-form'\n\t},\n\n\tchildViewEvents: {\n\t\t'childview:remove:file:click': 'onChildviewRemoveFileClick',\n\t\t'childview:add:file:click': 'onChildviewAddFileClick'\n\t},\n\n\tuploader: {},\n\n\t/**\n\t *\n\t */\n\tonBeforeRender: function () {\n\t\tif ( this.collection === undefined ) {\n\t\t\tthis.collection = new FileUploadCollection( this.fieldItemData );\n\t\t}\n\t},\n\n\tonRender: function () {\n\t\tconst listView = new FileUploadList( { collection: this.collection, fieldModel: this.model } );\n\t\tconst formView = new FileUploadForm( { fieldModel: this.model } );\n\n\t\tthis.showChildView( 'list', listView );\n\t\tthis.showChildView( 'form', formView );\n\n\t\t// Setup the uploader and listen for a response event\n\t\tthis.uploader = this.createUploader();\n\t\tthis.listenTo( this.uploader, 'added:files', this.onAddedFiles );\n\t},\n\n\t/**\n\t * Fired by a remove:file:click trigger in any child view\n\t *\n\t * @param childView View that was the source of the event\n\t */\n\tonChildviewRemoveFileClick: function ( childView ) {\n\t\tthis.collection.remove( childView.model );\n\t},\n\n\t/**\n\t * Fired by a add:file:click trigger in any child view\n\t *\n\t * plupload fields should never generate this event, it places a shim over our button and handles the\n\t * event internally.  But this event does still come through with plupload fields in some browser\n\t * environments for reasons we've been unable to determine.\n\t */\n\tonChildviewAddFileClick: function () {\n\n\t\t// Invoke the uploader\n\t\tif ( 'function' === typeof this.uploader.invoke ) {\n\t\t\tthis.uploader.invoke();\n\t\t}\n\t},\n\n\t/**\n\t * Concrete uploader implementations simply need to: this.trigger( 'added:files', newFiles )\n\t *\n\t * @param {Object[]} data An array of model objects to be added\n\t */\n\tonAddedFiles: function ( data ) {\n\t\tconst fieldConfig = this.model.get( 'fieldConfig' );\n\t\tconst fileLimit = +fieldConfig[ 'file_limit' ]; // Unary plus to force to number\n\t\tlet newCollection, filteredModels;\n\n\t\t// Get a copy of the existing collection with the new files added\n\t\tnewCollection = this.collection.clone();\n\t\tnewCollection.add( data );\n\n\t\t// Enforce the file limit option if one is set\n\t\tif ( UNLIMITED_FILES === fileLimit ) {\n\t\t\tfilteredModels = newCollection.models;\n\t\t} else {\n\t\t\t// Number of uploads is limited: keep the last N models, FIFO/queue style\n\t\t\tfilteredModels = newCollection.filter( function ( model ) {\n\t\t\t\treturn ( newCollection.indexOf( model ) >= newCollection.length - fileLimit );\n\t\t\t} );\n\t\t}\n\n\t\tthis.collection.reset( filteredModels );\n\t},\n\n\tcreateUploader: function () {\n\t\tconst fieldConfig = this.model.get( 'fieldConfig' );\n\t\tconst targetUploader = fieldConfig[ 'file_uploader' ];\n\t\tlet Uploader;\n\n\t\tjQuery.each( Uploaders, function ( index, thisUploader ) {\n\t\t\tif ( targetUploader === thisUploader.prototype.fileUploader ) {\n\t\t\t\tUploader = thisUploader;\n\t\t\t\treturn false;\n\t\t\t}\n\t\t} );\n\n\t\tif ( Uploader !== undefined ) {\n\t\t\tthis.uploader = new Uploader( {\n\t\t\t\t// We provide regular DOM element for the button\n\t\t\t\tbrowseButton: this.getRegion( 'form' ).getEl( '.pods-dfv-list-add' ).get(),\n\t\t\t\tuiRegion: this.getRegion( 'uiRegion' ),\n\t\t\t\tfieldConfig: fieldConfig\n\t\t\t} );\n\t\t\treturn this.uploader;\n\t\t} else {\n\t\t\t// @todo sprintf type with PodsI18n.__()\n\t\t\tthrow `Could not locate file uploader '${targetUploader}'`;\n\t\t}\n\t}\n} );\n","/* eslint-disable camelcase */\n/*global jQuery, _, Backbone, Marionette, wp, plupload, PodsI18n */\nimport { PodsFileUploader } from 'pods-dfv/_src/file-upload/uploaders/pods-file-uploader';\nimport { FileUploadQueueModel, FileUploadQueue } from 'pods-dfv/_src/file-upload/views/file-upload-queue';\n\nexport const Plupload = PodsFileUploader.extend( {\n\tplupload: {},\n\n\tfileUploader: 'plupload',\n\n\tinitialize: function () {\n\t\t// Set the browse button argument for plupload... it's required\n\t\tthis.fieldConfig[ 'plupload_init' ][ 'browse_button' ] = this.browseButton;\n\n\t\tthis.plupload = new plupload.Uploader( this.fieldConfig[ 'plupload_init' ] );\n\t\tthis.plupload.init();\n\n\t\t// Setup all callbacks: ( event_name, callback, context )\n\t\tthis.plupload.bind( 'FilesAdded', this.onFilesAdded, this );\n\t\tthis.plupload.bind( 'UploadProgress', this.onUploadProgress, this );\n\t\tthis.plupload.bind( 'FileUploaded', this.onFileUploaded, this );\n\t},\n\n\t/**\n\t * Fired after files have been selected from the dialog\n\t *\n\t * @param up\n\t * @param files\n\t */\n\tonFilesAdded: function ( up, files ) {\n\t\tlet model,\n\t\t\tcollection,\n\t\t\tview;\n\n\t\t// Assemble the collection data for the file queue\n\t\tcollection = new Backbone.Collection();\n\t\tjQuery.each( files, function ( index, file ) {\n\t\t\tmodel = new FileUploadQueueModel( {\n\t\t\t\tid: file.id,\n\t\t\t\tfilename: file.name\n\t\t\t} );\n\n\t\t\tcollection.add( model );\n\t\t} );\n\n\t\t// Create a new view based on the collection\n\t\tview = new FileUploadQueue( { collection: collection } );\n\t\tview.render();  // Generate the HTML, not attached to the DOM yet\n\n\t\t// Reset the region in case any error messages are hanging around from a previous upload\n\t\t// and show the new file upload queue\n\t\tthis.uiRegion.reset();\n\t\tthis.uiRegion.show( view );\n\n\t\t// Stash references\n\t\tthis.queueCollection = collection;\n\n\t\tup.refresh();\n\t\tup.start();\n\t},\n\n\t/**\n\t *\n\t * @param up\n\t * @param file\n\t */\n\tonUploadProgress: function ( up, file ) {\n\t\tconst model = this.queueCollection.get( file.id );\n\t\tmodel.set( { progress: file.percent } );\n\t},\n\n\t/**\n\t *\n\t * @param up\n\t * @param file\n\t * @param resp\n\t */\n\tonFileUploaded: function ( up, file, resp ) {\n\t\tconst model = this.queueCollection.get( file.id );\n\t\tlet response = resp.response;\n\t\tlet newFile = [];\n\t\tlet json;\n\n\t\t// Error condition 1\n\t\tif ( 'Error: ' === resp.response.substr( 0, 7 ) ) {\n\t\t\tresponse = response.substr( 7 );\n\t\t\tif ( window.console ) {\n\t\t\t\tconsole.log( response );\n\t\t\t}\n\n\t\t\tmodel.set( {\n\t\t\t\tprogress: 0,\n\t\t\t\terrorMsg: response\n\t\t\t} );\n\n\t\t\t// Error condition 2\n\t\t} else if ( '<e>' === resp.response.substr( 0, 3 ) ) {\n\t\t\tresponse = jQuery( response ).text(); // Strip tags, text only\n\t\t\tif ( window.console ) {\n\t\t\t\tconsole.log( response );\n\t\t\t}\n\n\t\t\tmodel.set( {\n\t\t\t\tprogress: 0,\n\t\t\t\terrorMsg: response\n\t\t\t} );\n\t\t} else {\n\t\t\tjson = response.match( /{.*}$/ );\n\n\t\t\tif ( null !== json && 0 < json.length ) {\n\t\t\t\tjson = jQuery.parseJSON( json[ 0 ] );\n\t\t\t} else {\n\t\t\t\tjson = {};\n\t\t\t}\n\n\t\t\tif ( 'object' !== typeof json || jQuery.isEmptyObject( json ) ) {\n\t\t\t\tif ( window.console ) {\n\t\t\t\t\tconsole.log( response );\n\t\t\t\t}\n\t\t\t\tif ( window.console ) {\n\t\t\t\t\tconsole.log( json );\n\t\t\t\t}\n\n\t\t\t\tmodel.set( {\n\t\t\t\t\tprogress: 0,\n\t\t\t\t\terrorMsg: PodsI18n.__( 'Error uploading file: ' ) + file.name\n\t\t\t\t} );\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tnewFile = {\n\t\t\t\tid: json.ID,\n\t\t\t\ticon: json.thumbnail,\n\t\t\t\tname: json.post_title,\n\t\t\t\tedit_link: json.edit_link,\n\t\t\t\tlink: json.link,\n\t\t\t\tdownload: json.download\n\t\t\t};\n\n\t\t\t// Remove the file from the upload queue model and trigger an event for the hosting container\n\t\t\tmodel.trigger( 'destroy', model );\n\t\t\tthis.trigger( 'added:files', newFile );\n\t\t}\n\t}\n\n} );\n\n","/* eslint-disable camelcase */\n/*global jQuery, _, Backbone, Marionette, wp, PodsI18n */\nimport { PodsFileUploader } from 'pods-dfv/_src/file-upload/uploaders/pods-file-uploader';\n\nexport const MediaModal = PodsFileUploader.extend( {\n\tmediaObject: {},\n\n\tfileUploader: 'attachment',\n\n\tinvoke: function () {\n\n\t\tif ( wp.Uploader.defaults.filters.mime_types === undefined ) {\n\t\t\twp.Uploader.defaults.filters.mime_types = [ {\n\t\t\t\ttitle: PodsI18n.__( 'Allowed Files' ),\n\t\t\t\textensions: '*'\n\t\t\t} ];\n\t\t}\n\n\t\tlet defaultExt = wp.Uploader.defaults.filters.mime_types[ 0 ].extensions;\n\n\t\twp.Uploader.defaults.filters.mime_types[ 0 ].extensions = this.fieldConfig[ 'limit_extensions' ];\n\n\t\t// set our settings\n\t\t// noinspection EqualityComparisonWithCoercionJS (\"1\" is every bit as valid to us as 1)\n\t\tthis.mediaObject = wp.media( {\n\t\t\ttitle: this.fieldConfig[ 'file_modal_title' ],\n\t\t\tmultiple: ( 1 != this.fieldConfig[ 'file_limit' ] ),\n\t\t\tlibrary: {\n\t\t\t\ttype: this.fieldConfig[ 'limit_types' ]\n\t\t\t},\n\t\t\t// Customize the submit button.\n\t\t\tbutton: {\n\t\t\t\t// Set the text of the button.\n\t\t\t\ttext: this.fieldConfig[ 'file_modal_add_button' ]\n\t\t\t}\n\t\t} );\n\n\t\t// One-shot callback ( event, callback, context )\n\t\tthis.mediaObject.once( 'select', this.onMediaSelect, this );\n\n\t\t// open the frame\n\t\tthis.mediaObject.open();\n\t\tthis.mediaObject.content.mode( this.fieldConfig[ 'file_attachment_tab' ] );\n\n\t\t// Reset the allowed file extensions\n\t\twp.Uploader.defaults.filters.mime_types[ 0 ].extensions = defaultExt;\n\t},\n\n\tonMediaSelect: function () {\n\t\tconst selection = this.mediaObject.state().get( 'selection' );\n\t\tlet newFiles = [];\n\n\t\tif ( !selection ) {\n\t\t\treturn;\n\t\t}\n\n\t\t// loop through the selected files\n\t\tselection.each( function ( attachment ) {\n\t\t\tconst sizes = attachment.attributes.sizes;\n\t\t\tlet attachmentThumbnail;\n\n\t\t\t// by default use the generic icon\n\t\t\tattachmentThumbnail = attachment.attributes.icon;\n\n\t\t\t// only thumbnails have sizes which is what we're on the hunt for\n\t\t\tif ( sizes !== undefined ) {\n\t\t\t\t// Get thumbnail if it exists\n\t\t\t\tif ( sizes.thumbnail !== undefined && sizes.thumbnail.url !== undefined ) {\n\t\t\t\t\tattachmentThumbnail = sizes.thumbnail.url;\n\t\t\t\t} else if ( sizes.full !== undefined && sizes.full.url !== undefined ) {\n\t\t\t\t\t// If thumbnail doesn't exist, get full because this is a small image\n\t\t\t\t\tattachmentThumbnail = sizes.full.url;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tnewFiles.push( {\n\t\t\t\tid: attachment.attributes.id,\n\t\t\t\ticon: attachmentThumbnail,\n\t\t\t\tname: attachment.attributes.title,\n\t\t\t\tedit_link: attachment.attributes.editLink,\n\t\t\t\tlink: attachment.attributes.link,\n\t\t\t\tdownload: attachment.attributes.url\n\t\t\t} );\n\t\t} );\n\n\t\t// Fire an event with an array of models to be added\n\t\tthis.trigger( 'added:files', newFiles );\n\t}\n\n} );\n","/*global jQuery, _, Backbone, Marionette, wp, PodsI18n */\n\n/**\n * A frame for displaying a modal popup with iframe content\n *\n * @augments wp.media.view.Frame\n */\nexport const PodsDFVModal = wp.media.view.Modal.extend( {\n\n\t/**\n\t * @param {Object} options\n\t * @returns {wp.media.view.Modal} Returns itself to allow chaining\n\t */\n\tclose: function ( options ) {\n\t\tconst retVal = wp.media.view.Modal.prototype.close.apply( this, options );\n\n\t\t// Alert the listening control when we've been cancelled\n\t\tif ( options && options.escape ) {\n\t\t\twindow.parent.jQuery( window.parent ).trigger( 'dfv:modal:cancel' );\n\t\t}\n\n\t\treturn retVal;\n\t}\n\n} );\n","/*global jQuery, _, Backbone, Marionette, wp, PodsI18n */\n\nimport { PodsDFVModal } from 'pods-dfv/_src/core/dfv-modal';\n\n/**\n * A frame for displaying a modal popup with iframe content\n *\n * @augments wp.media.view.Frame\n */\nexport const IframeFrame = wp.media.view.Frame.extend( {\n\tclassName: 'pods-modal-frame',\n\n\ttemplate: _.template( '<div class=\"media-frame-title\" /><div class=\"media-frame-iframe\" />' ),\n\n\tregions: [ 'title', 'iframe' ],\n\n\tinitialize: function () {\n\t\twp.media.view.Frame.prototype.initialize.apply( this, arguments );\n\n\t\t// Ensure core UI is enabled.\n\t\tthis.$el.addClass( 'wp-core-ui' );\n\n\t\tthis.initState();\n\t\tthis.initModal();\n\n\t\tthis.on( 'iframe:create:default', this.iframeContent, this );\n\t\tthis.iframe.mode( 'default' );\n\n\t\tthis.on( 'title:create:default', this.createTitle, this );\n\t\tthis.title.mode( 'default' );\n\t\tthis.on( 'title:render', function ( view ) {\n\t\t\tview.$el.append( '<span class=\"dashicons dashicons-arrow-down\"></span>' );\n\t\t} );\n\t},\n\n\tinitState: function () {\n\t\tconst title = this.options.title || PodsI18n.__( 'Add New Record' );\n\t\tconst src = this.options.src || '/';\n\n\t\tthis.states.add( [\n\t\t\tnew wp.media.controller.State( {\n\t\t\t\tid: 'default',\n\t\t\t\ttitle: title,\n\t\t\t\tsrc: src\n\t\t\t} )\n\t\t] );\n\n\t\tthis.options.state = 'default';\n\t},\n\n\tinitModal: function () {\n\t\tthis.modal = new PodsDFVModal( {\n\t\t\tcontroller: this\n\t\t} );\n\n\t\tthis.modal.content( this );\n\t},\n\n\trender: function () {\n\t\t// Activate the default state if no active state exists.\n\t\tif ( !this.state() && this.options.state ) {\n\t\t\tthis.setState( this.options.state );\n\t\t}\n\n\t\t/**\n\t\t * call 'render' directly on the parent class\n\t\t */\n\t\treturn wp.media.view.Frame.prototype.render.apply( this, arguments );\n\t},\n\n\t/**\n\t * @param {Object} content\n\t * @this wp.media.controller.Region\n\t */\n\tiframeContent: function ( content ) {\n\t\tcontent.view = new wp.media.view.Iframe( {\n\t\t\tcontroller: this\n\t\t} );\n\t},\n\n\tcreateTitle: function ( title ) {\n\t\ttitle.view = new wp.media.View( {\n\t\t\tcontroller: this,\n\t\t\ttagName: 'h1'\n\t\t} );\n\t}\n} );\n","/*global jQuery, _, Backbone, Marionette */\n\n/**\n *\n */\nexport const RelationshipModel = Backbone.Model.extend( {\n\tdefaults: {\n\t\t'id': 0,\n\t\t'name': '',\n\t\t'icon': '',\n\t\t'use_dashicon': false,\n\t\t'link': '',\n\t\t'edit_link': '',\n\t\t'selected': false\n\t},\n\n\ttoggleSelected: function () {\n\t\tthis.set( 'selected', !this.get( 'selected' ) );\n\t}\n} );\n\n/**\n *\n */\nexport const RelationshipCollection = Backbone.Collection.extend( {\n\tmodel: RelationshipModel,\n\n\t/**\n\t *\n\t * @param { ?string[] } ids\n\t */\n\tsetSelected: function ( ids ) {\n\t\tthis.map( function ( thisModel ) {\n\t\t\tconst selected = _.contains( ids, thisModel.get( 'id' ) + '' );\n\t\t\tthisModel.set( 'selected', selected );\n\t\t} );\n\t},\n\n\t/**\n\t * Return a new collection containing just the selected items in this one\n\t *\n\t * @returns {*}\n\t */\n\tfilterBySelected: function () {\n\n\t\t// Get an array with only the selected items\n\t\tconst filtered = this.filter( function ( itemModel ) {\n\t\t\treturn ( itemModel.get( 'selected' ) );\n\t\t} );\n\n\t\t// this.filter is going to return an array, so create a collection out of it\n\t\treturn new RelationshipCollection( filtered );\n\t},\n\n\t/**\n\t * Return a new collection containing just the unselected items in this one\n\t *\n\t * @returns {*}\n\t */\n\tfilterByUnselected: function () {\n\n\t\t// Get an array with only the unselected items\n\t\tconst filtered = this.filter( function ( itemModel ) {\n\t\t\treturn !( itemModel.get( 'selected' ) );\n\t\t} );\n\n\t\t// this.filter is going to return an array, so create a collection out of it\n\t\treturn new RelationshipCollection( filtered );\n\t}\n\n} );\n\n","/*global jQuery, _, Backbone, Marionette */\n\nexport const PickFieldModel = Backbone.Model.extend( {\n\tdefaults: {\n\t\t'view_name': 'select',\n\t\t'iframe_src': '',\n\t\t'pick_format_type': 'single',\n\t\t'pick_show_icon': false,\n\t\t'pick_show_view_link': false,\n\t\t'pick_show_edit_link': false\n\t}\n} );\n","/*global jQuery, _, Backbone, Marionette, wp */\nimport template from 'pods-dfv/_src/pick/views/radio-item.html';\n\nimport { PodsFieldListView, PodsFieldView } from 'pods-dfv/_src/core/pods-field-views';\n\n/**\n *\n */\nexport const RadioItem = PodsFieldView.extend( {\n\tchildViewEventPrefix: false, // Disable implicit event listeners in favor of explicit childViewTriggers and childViewEvents\n\n\ttagName: 'li',\n\n\ttemplate: _.template( template ),\n\n\ttemplateContext: function () {\n\t\treturn {\n\t\t\tordinal: this.model.collection.indexOf( this.model ) + 1 // One based indexing unlike checkboxes\n\t\t};\n\t},\n\n\tmodelChanged: function () {\n\t\tthis.render();\n\t}\n\n} );\n\n/**\n *\n */\nexport const RadioView = PodsFieldListView.extend( {\n\tchildViewEventPrefix: false, // Disable implicit event listeners in favor of explicit childViewTriggers and childViewEvents\n\n\ttagName: 'ul',\n\n\tclassName: 'pods-radio',\n\n\tchildView: RadioItem\n} );\n","/*global jQuery, _, Backbone, Marionette, wp */\nimport template from 'pods-dfv/_src/pick/views/checkbox-item.html';\n\nimport { PodsFieldListView, PodsFieldView } from 'pods-dfv/_src/core/pods-field-views';\n\n/**\n *\n */\nexport const CheckboxItem = PodsFieldView.extend( {\n\tchildViewEventPrefix: false, // Disable implicit event listeners in favor of explicit childViewTriggers and childViewEvents\n\n\ttagName: 'li',\n\n\ttemplate: _.template( template ),\n\n\tclassName: 'pods-pick',\n\n\tui: {\n\t\tcheckbox: 'input.pods-form-ui-field-type-pick'\n\t},\n\n\ttriggers: {\n\t\t'click @ui.checkbox': 'toggle:selected'\n\t},\n\n\tmodelEvents: {\n\t\t'change': 'modelChanged'\n\t},\n\n\ttemplateContext: function () {\n\t\treturn {\n\t\t\tordinal: this.model.collection.indexOf( this.model )\n\t\t};\n\t},\n\n\tmodelChanged: function () {\n\t\tthis.render();\n\t}\n} );\n\n/**\n *\n */\nexport const CheckboxView = PodsFieldListView.extend( {\n\tchildViewEventPrefix: false, // Disable implicit event listeners in favor of explicit childViewTriggers and childViewEvents\n\n\ttagName: 'ul',\n\n\tclassName: 'pods-checkbox-view',\n\n\tchildView: CheckboxItem,\n\n\tchildViewEvents: {\n\t\t'toggle:selected': 'onChildviewToggleSelected'\n\t},\n\n\t/**\n\t *\n\t */\n\tonAttach: function () {\n\n\t\t// Check initial selection limit status and enforce it if needed\n\t\tif ( !this.validateSelectionLimit() ) {\n\t\t\tthis.selectionLimitOver();\n\t\t}\n\t},\n\n\t/**\n\t *\n\t * @param childView\n\t */\n\tonChildviewToggleSelected: function ( childView ) {\n\n\t\tchildView.model.toggleSelected();\n\n\t\t// Dynamically enforce selection limit\n\t\tif ( this.validateSelectionLimit() ) {\n\t\t\tthis.selectionLimitUnder();\n\t\t} else {\n\t\t\tthis.selectionLimitOver();\n\t\t}\n\t},\n\n\t/**\n\t * @returns {boolean} true if unlimited selections are allowed or we're below the selection limit\n\t */\n\tvalidateSelectionLimit: function () {\n\t\tconst fieldConfig = this.fieldModel.get( 'fieldConfig' );\n\t\tlet limit, numSelected;\n\n\t\tlimit = +fieldConfig.pick_limit;  // Unary plus will implicitly cast to number\n\t\tnumSelected = this.collection.filterBySelected().length;\n\n\t\treturn 0 === limit || numSelected < limit;\n\t},\n\n\t/**\n\t *\n\t */\n\tselectionLimitOver: function () {\n\t\tthis.$el.find( 'input:checkbox:not(:checked)' ).prop( 'disabled', true );\n\t\tthis.trigger( 'selection:limit:over', this );\n\t},\n\n\t/**\n\t *\n\t */\n\tselectionLimitUnder: function () {\n\t\tthis.$el.find( 'input:checkbox' ).prop( 'disabled', false );\n\t\tthis.trigger( 'selection:limit:under', this );\n\t}\n\n} );\n","/*global jQuery, _, Backbone, Marionette, select2, sprintf, wp, ajaxurl, PodsI18n */\n\n// Note: this is a template-less view\nimport { PodsFieldListView, PodsFieldView } from 'pods-dfv/_src/core/pods-field-views';\nimport { RelationshipCollection } from 'pods-dfv/_src/pick/relationship-model';\n\nconst SELECT2_UL_TARGET = 'ul.select2-selection__rendered';\nconst SELECT2_SELECTED_TARGET = '.select2-selection__choice';\n\n/**\n * option\n *\n * @extends Backbone.View\n */\nexport const SelectItem = PodsFieldView.extend( {\n\tchildViewEventPrefix: false, // Disable implicit event listeners in favor of explicit childViewTriggers and childViewEvents\n\n\ttagName: 'option',\n\n\ttemplate: false,\n\n\tinitialize: function ( options ) {\n\t\tthis.$el.val( this.model.get( 'id' ) );\n\n\t\tthis.$el.html( this.model.get( 'name' ) );\n\n\t\tif ( this.model.get( 'selected' ) ) {\n\t\t\tthis.$el.prop( 'selected', 'selected' );\n\t\t}\n\t}\n} );\n\n/**\n * optgroup\n *\n * @extends Backbone.View\n */\nexport const Optgroup = PodsFieldListView.extend( {\n\tchildViewEventPrefix: false, // Disable implicit event listeners in favor of explicit childViewTriggers and childViewEvents\n\n\ttagName: 'optgroup',\n\n\tchildView: SelectItem,\n\n\tattributes: function () {\n\t\treturn {\n\t\t\tlabel: this.model.get( 'label' )\n\t\t};\n\t}\n} );\n\n/**\n * select\n *\n * @extends Backbone.View\n */\nexport const SelectView = Marionette.CollectionView.extend( {\n\tchildViewEventPrefix: false, // Disable implicit event listeners in favor of explicit childViewTriggers and childViewEvents\n\n\ttagName: 'select',\n\n\ttriggers: {\n\t\t'change': {\n\t\t\tevent: 'change:selected',\n\t\t\tstopPropagation: false\n\t\t}\n\t},\n\n\tmultiLastValidSelection: [],\n\n\t/**\n\t *\n\t * @param newCollection\n\t */\n\tsetCollection: function ( newCollection ) {\n\t\tthis.collection = newCollection;\n\t},\n\n\t/**\n\t *\n\t * @param options\n\t */\n\tinitialize: function ( options ) {\n\t\tthis.fieldModel = options.fieldModel;\n\t\tthis.fieldConfig = this.fieldModel.get( 'fieldConfig' );\n\t},\n\n\t/**\n\t * Set the proper child view (optgroups or no)\n\t *\n\t * @param item\n\t * @returns {*}\n\t */\n\tchildView: function ( item ) {\n\t\tif ( this.fieldConfig.optgroup ) {\n\t\t\treturn Optgroup;\n\t\t} else {\n\t\t\treturn SelectItem;\n\t\t}\n\t},\n\n\t/**\n\t * todo: We're bypassing the PodsFieldListView functionality, need to explicitly include it for now\n\t *\n\t * @param model\n\t * @param index\n\t * @returns {{fieldModel: *}}\n\t */\n\tchildViewOptions: function ( model, index ) {\n\t\tlet returnOptions = { fieldModel: this.fieldModel };\n\n\t\tif ( this.fieldConfig.optgroup ) {\n\t\t\treturnOptions.collection = new RelationshipCollection( model.get( 'collection' ) );\n\t\t}\n\n\t\treturn returnOptions;\n\t},\n\n\t/**\n\t * todo: We're bypassing the PodsFieldListView functionality, need to explicitly include it for now\n\t *\n\t * @returns {{}}\n\t */\n\tserializeData: function () {\n\t\tconst fieldModel = this.options.fieldModel;\n\t\tlet data = this.model ? this.model.toJSON() : {};\n\n\t\tdata.htmlAttr = fieldModel.get( 'attributes' );\n\t\tdata.fieldConfig = fieldModel.get( 'fieldConfig' );\n\n\t\treturn data;\n\t},\n\n\t/**\n\t *\n\t */\n\tattributes: function () {\n\n\t\t/**\n\t\t * @param {string} htmlAttr.name\n\t\t * @param {string} htmlAttr.class\n\t\t * @param {string} htmlAttr.name_clean\n\t\t * @param {string} htmlAttr.id\n\t\t *\n\t\t * @param {string} fieldConfig.pick_format_type 'single' or 'multi'\n\t\t */\n\t\tconst fieldModel = this.options.fieldModel;\n\t\tconst htmlAttr = fieldModel.get( 'htmlAttr' );\n\t\tconst fieldConfig = fieldModel.get( 'fieldConfig' );\n\n\t\tlet name = htmlAttr.name;\n\t\tif ( 'multi' === fieldConfig.pick_format_type ) {\n\t\t\tname = name + '[]';\n\t\t}\n\t\treturn {\n\t\t\t'name': name,\n\t\t\t'class': htmlAttr.class,\n\t\t\t'data-name-clean': htmlAttr.name_clean,\n\t\t\t'id': htmlAttr.id,\n\t\t\t'tabindex': '2',\n\t\t\t'multiple': ( 'multi' === fieldConfig.pick_format_type )\n\t\t};\n\t},\n\n\t/**\n\t * Setup to be done once attached to the DOM.  Select2 has some setup needs.\n\t *\n\t * @var {RelationshipCollection} this.collection\n\t */\n\tonAttach: function () {\n\t\tconst view_name = this.fieldConfig.view_name;\n\t\tconst format_type = this.fieldConfig.pick_format_type;\n\n\t\t// Initialize select2 fields\n\t\tif ( 'select2' === view_name ) {\n\t\t\tthis.setupSelect2();\n\t\t}\n\n\t\t// Check initial selection limit status for regular multiselect and enforce it if needed\n\t\tif ( 'select' === view_name && 'multi' === format_type ) {\n\n\t\t\t// Store initial selection in case we need to revert back from an invalid state\n\t\t\tthis.multiLastValidSelection = this.$el.val();\n\t\t}\n\n\t\t// If we're at the limit: disable all unselected items so no selections can be added\n\t\tif ( !this.validateSelectionLimit() ) {\n\t\t\tthis.selectionLimitOver();\n\t\t}\n\t},\n\n\t/**\n\t * @var {RelationshipCollection} this.collection\n\t */\n\tonChangeSelected: function () {\n\t\tconst limit = +this.fieldConfig.pick_limit; // Unary plus will implicitly cast to number\n\t\tconst view_name = this.fieldConfig.view_name;\n\t\tconst format_type = this.fieldConfig.pick_format_type;\n\n\t\t// Regular multiselect may need to reject the selection change\n\t\tif ( 'select' === view_name && 'multi' === format_type ) {\n\n\t\t\t// Has the selection gone OVER the limit?  Can occur with consecutive item selection.\n\t\t\tif ( null !== this.$el.val() && 0 !== limit && limit < this.$el.val().length ) {\n\n\t\t\t\t// Revert to the last valid selection and punt on what they attempted\n\t\t\t\tthis.$el.val( this.multiLastValidSelection );\n\t\t\t\twindow.alert( `${PodsI18n.__( 'You can only select' )} ${sprintf( PodsI18n._n( '%s item', '%s items', limit ), limit )}` );\n\t\t\t\tthis.trigger( 'childview:change:selected', this );\n\t\t\t\treturn;\n\t\t\t}\n\t\t}\n\n\t\t// Update the collection and last valid selection based on the new selections\n\t\tthis.collection.setSelected( this.$el.val() );\n\t\tthis.multiLastValidSelection = this.$el.val();\n\n\t\t// Dynamically enforce selection limits\n\t\tif ( this.validateSelectionLimit() ) {\n\t\t\tthis.selectionLimitUnder();\n\t\t} else {\n\t\t\tthis.selectionLimitOver();\n\t\t}\n\n\t\tthis.trigger( 'childview:change:selected', this );\n\t},\n\n\t/**\n\t * @var {RelationshipCollection} this.collection\n\t *\n\t * @returns {boolean} true if unlimited selections are allowed or we're below the selection limit\n\t */\n\tvalidateSelectionLimit: function () {\n\t\tlet limit, numSelected;\n\n\t\tlimit = +this.fieldConfig.pick_limit;  // Unary plus will implicitly cast to number\n\t\tnumSelected = this.collection.filterBySelected().length;\n\n\t\treturn 0 === limit || numSelected < limit;\n\t},\n\n\t/**\n\t *\n\t */\n\tselectionLimitOver: function () {\n\t\tconst viewName = this.fieldConfig.view_name;\n\t\tconst formatType = this.fieldConfig.pick_format_type;\n\n\t\tif ( 'select' === viewName && 'multi' === formatType ) {\n\t\t\t// At the limit: disable all unselected items so no further selections can be added\n\t\t\tthis.$el.find( 'option:not(:selected)' ).prop( 'disabled', true );\n\t\t}\n\n\t\tthis.trigger( 'childview:selection:limit:over', this );\n\t},\n\n\t/**\n\t *\n\t */\n\tselectionLimitUnder: function () {\n\t\tconst viewName = this.fieldConfig.view_name;\n\t\tconst formatType = this.fieldConfig.pick_format_type;\n\n\t\tif ( 'select' === viewName && 'multi' === formatType ) {\n\t\t\t// Not at limit, make sure all items are enabled\n\t\t\tthis.$el.find( 'option' ).prop( 'disabled', false );\n\t\t}\n\n\t\tthis.trigger( 'childview:selection:limit:under', this );\n\t},\n\n\t/**\n\t * No filtering, by default.  Consuming views can override this function to provide custom filtering\n\t * (e.g. List View needs to filter items already selected for its select from existing list)\n\t *\n\t * @param data\n\t */\n\tfilterAjaxList: function ( data ) {\n\t\tconst selectedItems = this.collection.filterBySelected();\n\t\tconst returnList = [];\n\n\t\t_.each( data.results, function ( element ) {\n\t\t\telement.text = element.name; // Select2 needs the \"text\" key but our model uses \"name\"\n\n\t\t\t// Only keep choices that haven't been selected yet, we don't want selected items in the autocomplete portion\n\t\t\tif ( !selectedItems.get( element.id ) ) {\n\t\t\t\treturnList.push( element );\n\t\t\t}\n\t\t} );\n\n\t\treturn { 'results': returnList };\n\t},\n\n\t/**\n\t * Initialize Select2, setup drag-drop reordering\n\t */\n\tsetupSelect2: function () {\n\t\tconst self = this;\n\t\tconst $select2 = this.$el;\n\t\tconst fieldConfig = this.options.fieldModel.get( 'fieldConfig' );\n\t\tconst ajaxData = fieldConfig.ajax_data;\n\t\tconst select2Overrides = fieldConfig.select2_overrides;\n\t\tconst limit = fieldConfig.pick_limit;\n\t\tconst isSingle = ( 'single' === fieldConfig.pick_format_type );\n\t\tconst selectedCount = this.collection.filterBySelected().length;\n\t\tlet $ulContainer, select2Options, placeholder;\n\n\t\t// 'placeholder' for single select requires an empty option.  None of the examples set selected but\n\t\t// it did not work for me in testing with just an empty option like the examples.\n\t\t//\n\t\t// https://select2.org/placeholders#single-select-placeholders\n\t\t// https://github.com/select2/select2/issues/3553\n\t\tif ( 0 === selectedCount && isSingle ) {\n\t\t\t$select2.prepend( '<option selected=\"selected\">' );\n\t\t}\n\n\t\t// ToDo:\n\t\t// limitDisable is only used to control the List View's select2 component, it won't be set\n\t\t// for regular autocomplete.  This function should be generic and not have to poke around with\n\t\t// special properties like this for exception cases.\n\t\tif ( fieldConfig.limitDisable ) {\n\t\t\tplaceholder = `${PodsI18n.__( 'You can only select' )} ${sprintf( PodsI18n._n( '%s item', '%s items', limit ), limit )}`;\n\t\t} else {\n\t\t\tplaceholder = `${PodsI18n.__( 'Search' )} ${fieldConfig.label}...`;\n\t\t}\n\n\t\tselect2Options = {\n\t\t\tmaximumSelectionLength: isSingle ? undefined : limit, // Should not be set for single select, messes up placeholder\n\t\t\tplaceholder: placeholder,\n\t\t\tallowClear: isSingle,\n\t\t\tdisabled: fieldConfig.limitDisable,\n\t\t\ttags: fieldConfig.pick_taggable,\n\t\t\tescapeMarkup: function ( text ) {\n\t\t\t\treturn text;\n\t\t\t}\n\t\t};\n\n\t\tif ( ajaxData.ajax ) {\n\t\t\tjQuery.extend( select2Options, {\n\t\t\t\tminimumInputLength: ajaxData.minimum_input_length,\n\t\t\t\tajax: {\n\t\t\t\t\turl: ajaxurl + '?pods_ajax=1',\n\t\t\t\t\ttype: 'POST',\n\t\t\t\t\tdataType: 'json',\n\t\t\t\t\tdelay: ajaxData.delay,\n\t\t\t\t\tdata: function ( params ) {\n\t\t\t\t\t\treturn {\n\t\t\t\t\t\t\t_wpnonce: ajaxData._wpnonce,\n\t\t\t\t\t\t\taction: 'pods_relationship',\n\t\t\t\t\t\t\tmethod: 'select2',\n\t\t\t\t\t\t\tpod: ajaxData.pod,\n\t\t\t\t\t\t\tfield: ajaxData.field,\n\t\t\t\t\t\t\turi: ajaxData.uri,\n\t\t\t\t\t\t\tid: ajaxData.id,\n\t\t\t\t\t\t\tquery: params.term // ToDo: term{lang}\n\t\t\t\t\t\t};\n\t\t\t\t\t},\n\t\t\t\t\tprocessResults: function ( data, params ) {\n\t\t\t\t\t\treturn self.filterAjaxList( data, params );\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t} );\n\t\t}\n\n\t\t// Initialize select2\n\t\t$select2.selectWoo( jQuery.extend( true, select2Options, select2Overrides ) );\n\n\t\t// Get a reference to the ul container of the visual UI portion.  Can't do this until select2 is initialized\n\t\t$ulContainer = $select2.parent().find( SELECT2_UL_TARGET );\n\n\t\t// Make the list drag-drop sortable\n\t\t$ulContainer.sortable( {\n\t\t\tcontainment: 'parent'\n\t\t} );\n\n\t\t// With select2 4.0, sortable is just reordering the UI elements.  Keep the underlying select/option list\n\t\t// synced with the changes.  See: https://github.com/select2/select2/issues/3004\n\t\t$ulContainer.on( 'sortstop', function () {\n\t\t\tconst $selected = $ulContainer.find( SELECT2_SELECTED_TARGET ).get().reverse();\n\n\t\t\tjQuery( $selected ).each( function () {\n\t\t\t\tconst id = jQuery( this ).data( 'data' ).id;\n\t\t\t\tconst option = $select2.find( 'option[value=\"' + id + '\"]' )[ 0 ];\n\n\t\t\t\t$select2.prepend( option );\n\t\t\t} );\n\t\t} );\n\t}\n\n} );\n","/*global jQuery, _, Backbone, Marionette, wp */\nimport template from 'pods-dfv/_src/pick/views/list-item.html';\n\nimport { PodsFieldListView, PodsFieldView } from 'pods-dfv/_src/core/pods-field-views';\n\n/**\n *\n */\nexport const ListItem = PodsFieldView.extend( {\n\tchildViewEventPrefix: false, // Disable implicit event listeners in favor of explicit childViewTriggers and childViewEvents\n\n\ttagName: 'li',\n\n\tclassName: 'pods-dfv-list-item pods-relationship',\n\n\ttemplate: _.template( template ),\n\n\tui: {\n\t\tremoveButton: '.pods-dfv-list-remove a',\n\t\teditButton: '.pods-dfv-list-edit a'\n\t},\n\n\ttriggers: {\n\t\t'click @ui.removeButton': 'remove:item:click',\n\t\t'click @ui.editButton': 'edit:item:click'\n\t},\n\n\ttemplateContext: function () {\n\t\treturn {\n\t\t\tordinal: this.model.collection.indexOf( this.model )\n\t\t};\n\t}\n\n} );\n\n/**\n *  Represents the markup of the container as a whole\n */\nexport const ListView = PodsFieldListView.extend( {\t// Cache the template function for the overall container\n\tchildViewEventPrefix: false, // Disable implicit event listeners in favor of explicit childViewTriggers and childViewEvents\n\n\ttagName: 'ul',\n\n\tclassName: 'pods-dfv-list pods-relationship',\n\n\tchildView: ListItem,\n\n\t// Pass these up the containment chain\n\tchildViewTriggers: {\n\t\t'remove:item:click': 'childview:remove:item:click',\n\t\t'edit:item:click': 'childview:edit:item:click'\n\t},\n\n\tfilter: function ( child, index, collection ) {\n\t\treturn child.attributes.selected;\n\t},\n\n\tonAttach: function () {\n\t\tconst fieldConfig = this.options.fieldModel.get( 'fieldConfig' );\n\n\t\t// @todo\n\t\t// http://stackoverflow.com/questions/1735372/jquery-sortable-list-scroll-bar-jumps-up-when-sorting/4187833#4187833\n\n\t\tif ( 1 !== fieldConfig[ 'pick_limit' ] ) {\n\t\t\t// init sortable\n\t\t\tthis.$el.sortable( {\n\t\t\t\tcontainment: 'parent',\n\t\t\t\taxis: 'y',\n\t\t\t\tscrollSensitivity: 40,\n\t\t\t\ttolerance: 'pointer',\n\t\t\t\topacity: 0.6\n\t\t\t} );\n\t\t}\n\t}\n\n} );\n","/*global jQuery, _, Backbone, Marionette, wp */\nimport template from 'pods-dfv/_src/pick/views/add-new.html';\n\nimport { PodsFieldView } from 'pods-dfv/_src/core/pods-field-views';\n\nconst DISABLED_CLASS = 'button-disabled';\n\nexport const AddNew = PodsFieldView.extend( {\n\tchildViewEventPrefix: false, // Disable implicit event listeners in favor of explicit childViewTriggers and childViewEvents\n\n\ttagName: 'div',\n\n\tclassName: 'podsform-dfv-list-relationship-container',\n\n\tui: {\n\t\taddButton: 'a.pods-related-add-new'\n\t},\n\n\ttemplate: _.template( template ),\n\n\ttriggers: {\n\t\t'click @ui.addButton': 'add:new:click'\n\t},\n\n\t/**\n\t *\n\t */\n\tdisable: function () {\n\t\tconst addButton = this.getUI( 'addButton' );\n\t\taddButton.addClass( DISABLED_CLASS ); // Note: this just styles the link (button), click event enforces\n\t},\n\n\t/**\n\t *\n\t */\n\tenable: function () {\n\t\tconst addButton = this.getUI( 'addButton' );\n\t\taddButton.removeClass( DISABLED_CLASS ); // Note: this just styles the link (button), click event enforces\n\t},\n\n\t/**\n\t *\n\t */\n\tonAddNewClick: function () {\n\t\tconst addButton = this.getUI( 'addButton' );\n\n\t\t// Only pass the event up the view chain if we're enabled\n\t\tif ( !addButton.hasClass( DISABLED_CLASS ) ) {\n\t\t\tthis.trigger( 'childview:add:new', this );\n\t\t}\n\t}\n} );\n","/* eslint-disable camelcase */\n/*global jQuery, _, Backbone, Marionette, wp, PodsI18n */\n\nimport template from 'pods-dfv/_src/pick/pick-layout.html';\n\nimport { PodsDFVFieldModel } from 'pods-dfv/_src/core/pods-field-model';\nimport { PodsDFVFieldLayout } from 'pods-dfv/_src/core/pods-field-views';\n\nimport { IframeFrame } from 'pods-dfv/_src/core/iframe-frame';\n\nimport { RelationshipCollection } from 'pods-dfv/_src/pick/relationship-model';\nimport { PickFieldModel } from 'pods-dfv/_src/pick/pick-field-model';\n\nimport { RadioView } from 'pods-dfv/_src/pick/views/radio-view';\nimport { CheckboxView } from 'pods-dfv/_src/pick/views/checkbox-view';\nimport { SelectView } from 'pods-dfv/_src/pick/views/select-view';\nimport { ListView } from 'pods-dfv/_src/pick/views/list-view';\nimport { AddNew } from 'pods-dfv/_src/pick/views/add-new';\n\nconst views = {\n\t'checkbox': CheckboxView,\n\t'select': SelectView,\n\t'select2': SelectView,  // SelectView handles select2 as well\n\t'radio': RadioView,\n\t'list': ListView\n};\n\nlet modalIFrame;\n\n/**\n * @extends Backbone.View\n */\nexport const Pick = PodsDFVFieldLayout.extend( {\n\tchildViewEventPrefix: false, // Disable implicit event listeners in favor of explicit childViewTriggers and childViewEvents\n\n\ttemplate: _.template( template ),\n\n\tregions: {\n\t\tautocomplete: '.pods-ui-list-autocomplete',\n\t\tlist: '.pods-pick-values',\n\t\taddNew: '.pods-ui-add-new'\n\t},\n\n\tchildViewEvents: {\n\t\t'childview:remove:item:click': 'onChildviewRemoveItemClick',\n\t\t'childview:edit:item:click': 'onChildviewEditItemClick',\n\t\t'childview:selection:limit:over': 'onChildviewSelectionLimitOver',\n\t\t'childview:selection:limit:under': 'onChildviewSelectionLimitUnder',\n\t\t'childview:change:selected': 'onChildviewChangeSelected',\n\t\t'childview:add:new': 'onChildviewAddNew'\n\t},\n\n\t/**\n\t *\n\t */\n\tonBeforeRender: function () {\n\t\tif ( this.collection === undefined ) {\n\t\t\tthis.collection = new RelationshipCollection( this.fieldItemData );\n\t\t}\n\t},\n\n\t/**\n\t *\n\t */\n\tonRender: function () {\n\t\tthis.fieldConfig = new PickFieldModel( this.model.get( 'fieldConfig' ) );\n\n\t\t// Add New?\n\t\t// noinspection EqualityComparisonWithCoercionJS (why would we reject \"1\"?)\n\t\tif ( '' !== this.fieldConfig.get( 'iframe_src' ) && 1 == this.fieldConfig.get( 'pick_allow_add_new' ) ) {\n\t\t\tthis.showAddNew();\n\t\t}\n\n\t\t// Autocomplete?\n\t\tif ( 'list' === this.fieldConfig.get( 'view_name' ) ) {\n\t\t\tthis.buildAutocomplete();\n\t\t}\n\n\t\t// Build the list last, events fired by the list (like selection limit) may impact state in other views we manage\n\t\tthis.showList();\n\t},\n\n\t/**\n\t * This is for the List View's autocomplete for select from existing\n\t */\n\tbuildAutocomplete: function () {\n\t\tlet fieldConfig, model, collection, view;\n\t\tconst pickLimit = +this.fieldConfig.get( 'pick_limit' ); // Unary plus forces cast to number\n\n\t\tfieldConfig = {\n\t\t\tview_name: 'select2',\n\t\t\tpick_format_type: 'multi',\n\t\t\tselectFromExisting: true,\n\t\t\tajax_data: this.fieldConfig.get( 'ajax_data' ),\n\t\t\tselect2_overrides: this.fieldConfig.get( 'select2_overrides' ),\n\t\t\tlabel: this.fieldConfig.get( 'label' ),\n\t\t\tpick_limit: pickLimit\n\t\t};\n\n\t\t// The autocomplete portion of List View doesn't track selected items; disable if we're at the selection limit\n\t\tif ( this.collection.filterBySelected().length >= pickLimit && 0 !== pickLimit ) {\n\n\t\t\tfieldConfig.limitDisable = true;\n\t\t\tthis.onChildviewSelectionLimitOver();\n\n\t\t} else {\n\n\t\t\tthis.onChildviewSelectionLimitUnder();\n\t\t}\n\n\t\tmodel = new PodsDFVFieldModel( { fieldConfig: fieldConfig } );\n\t\tcollection = this.collection.filterByUnselected();\n\t\tview = new SelectView( { collection: collection, fieldModel: model } );\n\n\t\t// Provide a custom list filter for the autocomplete portion's AJAX data lists\n\t\tview.filterAjaxList = this.filterAjaxList.bind( this );\n\n\t\t// Destroy any existing view and rebuild from scratch\n\t\tif ( this.getChildView( 'autocomplete' ) ) {\n\t\t\tthis.getChildView( 'autocomplete' ).destroy();\n\t\t}\n\n\t\tthis.showChildView( 'autocomplete', view );\n\t},\n\n\t/**\n\t *\n\t */\n\tshowList: function () {\n\t\tlet viewName, View, list;\n\n\t\t// Setup the view to be used\n\t\tviewName = this.fieldConfig.get( 'view_name' );\n\t\tif ( views[ viewName ] === undefined ) {\n\t\t\tthrow new Error( `Invalid view name \"${viewName}\"` );\n\t\t}\n\t\tView = views[ viewName ];\n\t\tlist = new View( { collection: this.collection, fieldModel: this.model } );\n\n\t\tthis.showChildView( 'list', list );\n\t},\n\n\t/**\n\t *\n\t */\n\tshowAddNew: function () {\n\t\tlet addNew = new AddNew( { fieldModel: this.model } );\n\t\tthis.showChildView( 'addNew', addNew );\n\t},\n\n\t/**\n\t * List Views need to filter items already selected from their select from existing list.  The AJAX function\n\t * itself does not filter.\n\t *\n\t * @param data\n\t */\n\tfilterAjaxList: function ( data ) {\n\t\tconst selectedItems = this.collection.filterBySelected();\n\t\tconst returnList = [];\n\n\t\t// Loop through the items returned via ajax\n\t\t_.each( data.results, function ( element ) {\n\t\t\telement.text = element.name; // Select2 needs the \"text\" key but our model uses \"name\"\n\n\t\t\t// Only keep choices that haven't been selected yet, we don't want selected items in the autocomplete portion\n\t\t\tif ( !selectedItems.get( element.id ) ) {\n\t\t\t\treturnList.push( element );\n\t\t\t}\n\t\t} );\n\n\t\t// The collection may be partial in ajax mode, make sure we add any items we didn't yet have\n\t\tthis.collection.add( returnList );\n\t\tthis.getChildView( 'autocomplete' ).setCollection( this.collection.filterByUnselected() );\n\n\t\treturn { 'results': returnList };\n\t},\n\n\t/**\n\t *\n\t * @param childView\n\t */\n\tonChildviewSelectionLimitOver: function ( childView ) {\n\t\tconst addNew = this.getChildView( 'addNew' );\n\t\tif ( addNew ) {\n\t\t\taddNew.disable();\n\t\t}\n\t},\n\n\t/**\n\t *\n\t * @param childView\n\t */\n\tonChildviewSelectionLimitUnder: function ( childView ) {\n\t\tconst addNew = this.getChildView( 'addNew' );\n\t\tif ( addNew ) {\n\t\t\taddNew.enable();\n\t\t}\n\t},\n\n\t/**\n\t * \"Remove\" in list view just toggles an item's selected attribute\n\t *\n\t * @param childView\n\t */\n\tonChildviewRemoveItemClick: function ( childView ) {\n\t\tchildView.model.toggleSelected();\n\t\tthis.getChildView( 'list' ).render();\n\n\t\t// Keep autocomplete in sync, removed items should now be available choices\n\t\tif ( 'list' === this.fieldConfig.get( 'view_name' ) ) {\n\t\t\tthis.buildAutocomplete();\n\t\t}\n\t},\n\n\t/**\n\t * @param childView\n\t */\n\tonChildviewAddNew: function ( childView ) {\n\t\tconst fieldConfig = this.model.get( 'fieldConfig' );\n\n\t\tmodalIFrame = new IframeFrame( {\n\t\t\ttitle: fieldConfig.iframe_title_add,\n\t\t\tsrc: fieldConfig.iframe_src\n\t\t} );\n\n\t\tthis.setModalListeners();\n\t\tmodalIFrame.modal.open();\n\t},\n\n\t/**\n\t * @param childView\n\t */\n\tonChildviewEditItemClick: function ( childView ) {\n\t\tconst fieldConfig = this.model.get( 'fieldConfig' );\n\n\t\tmodalIFrame = new IframeFrame( {\n\t\t\ttitle: fieldConfig.iframe_title_edit,\n\t\t\tsrc: childView.ui.editButton.attr( 'href' )\n\t\t} );\n\n\t\tthis.setModalListeners();\n\t\tmodalIFrame.modal.open();\n\t},\n\n\t/**\n\t *\n\t * @param childView\n\t */\n\tonChildviewChangeSelected: function ( childView ) {\n\n\t\t// Refresh the autocomplete and List View lists on autocomplete selection\n\t\tif ( childView.fieldConfig.selectFromExisting ) {\n\t\t\tthis.buildAutocomplete();\n\t\t\tthis.getChildView( 'list' ).render();\n\t\t}\n\t},\n\n\tsetModalListeners: function () {\n\t\tjQuery( window ).on( 'dfv:modal:update', this.modalSuccess.bind( this ) );\n\t\tjQuery( window ).on( 'dfv:modal:cancel', this.modalCancel.bind( this ) );\n\t},\n\n\tclearModalListeners: function () {\n\t\tjQuery( window ).off( 'dfv:modal:update' );\n\t\tjQuery( window ).off( 'dfv:modal:cancel' );\n\t},\n\n\t/**\n\t * @param event\n\t * @param data\n\t */\n\tmodalSuccess: function ( event, data ) {\n\t\tconst itemModel = this.collection.get( data.id );\n\n\t\tif ( itemModel ) {\n\t\t\t// Edit: update an existing model and force a re-render\n\t\t\titemModel.set( data );\n\t\t\tthis.getChildView( 'list' ).render();\n\t\t} else {\n\t\t\t// Add new: create a new model in the collection\n\t\t\tthis.collection.add( data );\n\t\t}\n\n\t\tthis.clearModalListeners();\n\t\tmodalIFrame.modal.close( {} );\n\t},\n\n\t/**\n\t *\n\t */\n\tmodalCancel: function () {\n\t\tthis.clearModalListeners();\n\t}\n\n} );\n","/*global jQuery, _, Backbone, Marionette */\nimport { PodsDFVFieldModel } from 'pods-dfv/_src/core/pods-field-model';\nimport { PodsGbModalListener } from 'pods-dfv/_src/core/gb-modal-listener';\nimport * as fields from 'pods-dfv/_src/field-manifest';\nimport * as models from 'pods-dfv/_src/model-manifest';\n\nconst INIT_TARGETS = '.pods-form-ui-field';           // Where to look for scripts\nconst SCRIPT_TARGET = 'script.pods-dfv-field-data';   // What scripts to look for\n\n// key: FieldClass\nconst fieldClasses = {\n\t'file': fields.FileUpload,\n\t'avatar': fields.FileUpload,\n\t'pick': fields.Pick\n};\n\nconst PodsDFV = {\n\tfields: fields,\n\tmodels: models,\n\tfieldInstances: {},\n\n\t/**\n\t *\n\t */\n\tinit: function () {\n\t\tlet self = this;\n\n\t\t// Loop through any targets that may contain scripts\n\t\tjQuery( INIT_TARGETS ).each( function () {\n\t\t\tlet FieldClass, newField, fieldModel;\n\t\t\tlet data = { fieldType: undefined };\n\n\t\t\t// Combine data from all in-line data scripts in the container\n\t\t\t// and remove the scripts from the page\n\t\t\tjQuery( this ).find( SCRIPT_TARGET ).each( function () {\n\t\t\t\tconst newData = jQuery.parseJSON( jQuery( this ).html() );\n\n\t\t\t\t// Kludge to disable the \"Add New\" button if we're inside a media modal.  This should\n\t\t\t\t// eventually be ironed out so we can use Add New from this context (see #4864\n\t\t\t\tif ( jQuery( this ).parents( '.media-modal-content' ).length ) {\n\t\t\t\t\tnewData.fieldConfig.pick_allow_add_new = 0;\n\t\t\t\t}\n\n\t\t\t\tjQuery.extend( data, newData );\n\t\t\t\tjQuery( this ).remove();\n\t\t\t} );\n\n\t\t\t// Ignore anything that doesn't have the field type set\n\t\t\tif ( data.fieldType !== undefined ) {\n\n\t\t\t\t// See if we can locate a class to be instantiated by field type\n\t\t\t\tFieldClass = fieldClasses[ data.fieldType ];\n\t\t\t\tif ( FieldClass !== undefined ) {\n\n\t\t\t\t\t// Assemble the model and create the field\n\t\t\t\t\tfieldModel = new PodsDFVFieldModel( {\n\t\t\t\t\t\thtmlAttr: data.htmlAttr,\n\t\t\t\t\t\tfieldConfig: data.fieldConfig\n\t\t\t\t\t} );\n\n\t\t\t\t\tnewField = new FieldClass( {\n\t\t\t\t\t\tel: this,\n\t\t\t\t\t\tmodel: fieldModel,\n\t\t\t\t\t\tfieldItemData: data.fieldItemData\n\t\t\t\t\t} );\n\n\t\t\t\t\t// Render the field, trigger an event for the outside world, and stash a reference\n\t\t\t\t\tnewField.render();\n\t\t\t\t\tjQuery( this ).trigger( 'render' );\n\t\t\t\t\tself.fieldInstances[ data.htmlAttr.id ] = newField;\n\t\t\t\t}\n\t\t\t}\n\t\t} );\n\t},\n\n\tisModalWindow: function () {\n\t\treturn ( -1 !== location.search.indexOf( 'pods_modal=' ) );\n\t},\n\n\tisGutenbergEditorLoaded: function () {\n\t\treturn ( wp.data !== undefined && wp.data.subscribe !== undefined );\n\t}\n};\nexport default PodsDFV;\n\n/**\n * Kick everything off on DOMContentLoaded\n */\ndocument.addEventListener( 'DOMContentLoaded', () => {\n\tPodsDFV.init();\n\n\t// Load the Gutenberg modal listener if we're inside a Pods modal with Gutenberg active\n\tif ( PodsDFV.isModalWindow() && PodsDFV.isGutenbergEditorLoaded()) {\n\t\tPodsGbModalListener.init();\n\t}\n} );\n"],"names":["PodsDFVFieldModel","Backbone","Model","extend","editorData","wp","data","select","unSubscribe","PodsGbModalListener","isCurrentPostPublished","subscribe","saveListener","publishListener","getPermalink","getCurrentPostId","wasSaving","isSavingPost","didPostSaveRequestSucceed","isAutosavingPost","triggerUpdateEvent","optionalData","defaultData","getCurrentPostAttribute","postData","Object","assign","parent","jQuery","window","trigger","PodsFieldListView","Marionette","CollectionView","options","fieldModel","childViewOptions","PodsFieldView","View","this","model","toJSON","htmlAttr","get","fieldConfig","PodsDFVFieldLayout","fieldItemData","FileUploadModel","FileUploadCollection","Collection","FileUploadItem","_","template","FileUploadList","sort_axis","$el","sortable","FileUploadForm","PodsFileUploader","browseButton","uiRegion","call","FileUploadQueueModel","FileUploadQueueItem","render","FileUploadQueue","Uploaders","plupload","Uploader","init","bind","onFilesAdded","onUploadProgress","onFileUploaded","up","files","collection","view","each","index","file","id","name","add","reset","show","queueCollection","refresh","start","set","progress","percent","resp","response","newFile","json","substr","console","log","text","match","length","parseJSON","isEmptyObject","PodsI18n","__","ID","thumbnail","post_title","edit_link","link","download","undefined","defaults","filters","mime_types","defaultExt","extensions","mediaObject","media","once","onMediaSelect","open","content","mode","selection","state","newFiles","attachment","sizes","attributes","attachmentThumbnail","icon","url","full","push","title","editLink","FileUpload","listView","formView","showChildView","uploader","createUploader","listenTo","onAddedFiles","childView","remove","invoke","fileLimit","newCollection","filteredModels","clone","models","filter","indexOf","targetUploader","thisUploader","prototype","fileUploader","getRegion","getEl","PodsDFVModal","Modal","retVal","close","apply","escape","IframeFrame","Frame","initialize","arguments","addClass","initState","initModal","on","iframeContent","iframe","createTitle","append","src","states","controller","State","modal","setState","Iframe","RelationshipModel","RelationshipCollection","ids","map","thisModel","selected","contains","filtered","itemModel","PickFieldModel","RadioItem","RadioView","CheckboxItem","CheckboxView","validateSelectionLimit","selectionLimitOver","toggleSelected","selectionLimitUnder","limit","numSelected","pick_limit","filterBySelected","find","prop","SelectItem","val","html","Optgroup","SelectView","item","optgroup","returnOptions","pick_format_type","class","name_clean","view_name","format_type","setupSelect2","multiLastValidSelection","alert","sprintf","_n","setSelected","viewName","formatType","selectedItems","returnList","results","element","select2Options","self","$select2","ajaxData","ajax_data","select2Overrides","select2_overrides","isSingle","selectedCount","$ulContainer","prepend","limitDisable","label","pick_taggable","ajax","minimum_input_length","ajaxurl","delay","params","_wpnonce","pod","field","uri","term","filterAjaxList","selectWoo","$selected","reverse","option","ListItem","ListView","child","DISABLED_CLASS","AddNew","getUI","removeClass","hasClass","views","modalIFrame","Pick","showAddNew","buildAutocomplete","showList","pickLimit","onChildviewSelectionLimitOver","onChildviewSelectionLimitUnder","filterByUnselected","getChildView","destroy","list","Error","addNew","setCollection","disable","enable","iframe_title_add","iframe_src","setModalListeners","iframe_title_edit","ui","editButton","attr","selectFromExisting","modalSuccess","modalCancel","off","event","clearModalListeners","fieldClasses","fields","PodsDFV","FieldClass","newField","fieldType","newData","parents","pick_allow_add_new","fieldInstances","location","search","document","addEventListener","isModalWindow","isGutenbergEditorLoaded"],"mappings":"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"}